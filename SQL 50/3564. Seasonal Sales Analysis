# Write your MySQL query statement below

WITH seas AS (
    SELECT (
            CASE WHEN MONTH(sale_date) IN (12, 1, 2) THEN 'Winter' 
            WHEN MONTH(sale_date) IN (3, 4, 5) THEN 'Spring' 
            WHEN MONTH(sale_date) IN (6, 7, 8) THEN 'Summer' 
            ELSE 'Fall' 
            END 
        ) AS season, 
        p.category , 
        SUM(quantity) AS total_quantity, 
        SUM(quantity*price) AS total_revenue

FROM sales 
JOIN products AS p
on p.product_id = sales.product_id
GROUP BY season, category
ORDER BY total_quantity DESC, total_revenue DESC
)
-- select * from seas;
SELECT season, category, MAX(total_quantity) AS total_quantity, total_revenue
FROM seas
GROUP BY season
ORDER BY season